define("codeOutput",["exports"],function(a){function b(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function d(a){return-1!==Object.keys(m).indexOf(a)}var e={},f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function n(a,b,d,e,f){var g=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";c(this,n),this.files=[];var h={cpp:"cpp",c:"c",java:"java",python:"py",python3:"py"};if("string"==typeof a){var j="main."+h[e];this.files=[new i(HandlebarsComplete.compile(j),!0,HandlebarsComplete.compile(a))]}else{this.files=a.map(function(a){return new i(HandlebarsComplete.compile(a.filename),a.main,HandlebarsComplete.compile(a.program))}),0===this.files.filter(function(a){return a.main}).length&&(this.files[0].main=!0);var k=this.files.find(function(a){return a.main}),l=this.files.indexOf(k);this.files.splice(l,1),this.files.unshift(k)}this.parameters=b||"",this.explanation=HandlebarsComplete.compile(d),this.language=e,this.input=HandlebarsComplete.compile(f),this.outputFilename=HandlebarsComplete.compile(g)},i=function o(a,b,d){c(this,o),this.filename=a,this.main=Boolean(b),this.program=d,this.programToShow=null},j=function(){function a(b,d,e,f,g){var h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";c(this,a),this.code=b,this.explanation=d,this.language=e,this.files=g,this.input=f,this.useOutputFile=""!==h,this.outputFilename=h,this.hasInput=""!==this.input,this.expectedAnswer=null,this.serverRequestPromise=null,this.rejectPreviousRequest=null}return g(a,[{key:"stopServerRequest",value:function(){this.rejectPreviousRequest(),this.rejectPreviousRequest=null}},{key:"isServerRequestRejected",value:function(){return this.serverRequestPromise.isRejected}},{key:"programError",value:function(a){alert("Error in generated program:\n"+a)}},{key:"setExpectedAnswer",value:function(a){d(this.language)?this.setExpectedAnswerViaZyFlowchartExecution():this.setExpectedAnswerViaServerRequests(a)}},{key:"setExpectedAnswerViaZyFlowchartExecution",value:function(){var a=this;this.serverRequestPromise=new Ember.RSVP.Promise(function(b,c){a.rejectPreviousRequest=c;var d=null;try{d=require("zyFlowchartSDK").create().makeExecutor(a.code,a.input,!0)}catch(e){a.programError(e),c(e)}for(d.enterExecution();!d.isExecutionDone();)d.execute();a.expectedAnswer=d.output.output,b()})}},{key:"setExpectedAnswerViaServerRequests",value:function(a){var b=this,c="We can't seem to reach our server. Please check your Internet connection, or try refreshing the page.",d=this.files.find(function(a){return a.main})||this.files[0],e=d.filename,f=this.files.map(function(a){var b=new Blob([a.program]);return b.lastModifiedDate=new Date,b.name=a.filename,b}),g=this.useOutputFile?[this.outputFilename]:[],h=require("utilities").getRunCodeFormDataObject("explore",this.language,e,this.input,f,g);this.serverRequestPromise=new Ember.RSVP.Promise(function(d,e){b.rejectPreviousRequest=e,a.runCode(h).then(function(a){var c=a.output;c.compile_error&&(b.programError(c.compile_error),e(c.compile_error)),c.compile_warning&&(b.programError(c.compile_warning),e(c.compile_warning)),c.error&&(b.programError(c.error),e(c.error)),b.expectedAnswer=b.useOutputFile?c.output_files[b.outputFilename]:c.output,d()},function(){e(c)})})}}]),a}(),k=function(){function a(b,d){c(this,a),this.levels=b,this.shownLevels=b.map(function(){return new Set}),this.globalCode=d}return g(a,[{key:"make",value:function(a){var b=this.levels[a],c=b.parameters,e="object"!==("undefined"==typeof c?"undefined":f(c)),g={},h=null,k=require("utilities"),l="",m="",n="";if(e){var o=this.globalCode+"\n\n"+c;if(h=k.makePythonModuleWithErrorCheck(o),!h)return null;l=k.replaceStringVariables(b.explanation(),h),m=k.replaceStringVariables(b.input(),h),n=k.replaceStringVariables(b.outputFilename(),h)}else g=k.getParameterCombination(c),m=b.input(g),n=b.outputFilename(g);d(b.language)&&HandlebarsComplete.registerHelper("executeForFinalValueOf",function(){return"|Error: executeForFinalValueOf only for explanation|"});var p=b.files.map(function(a){var b="",c="";if(e?(b=k.replaceStringVariables(a.program(),h),c=k.replaceStringVariables(a.filename(),h)):(b=a.program(g),c=a.filename(g)),"main.java"===c){var d=/public\s*class\s*([a-zA-Z0-9_]*)/,f=b.match(d),j=null;f&&(j=f[1]),j||window.alert("Failed to guess the file's name. Please name the file like the public class's name in the file."),c=j?j+".java":c}return new i(c,a.main,b)}),q=p.find(function(a){return a.main}).program;d(b.language)&&HandlebarsComplete.registerHelper("executeForFinalValueOf",function(a){var b=require("zyFlowchartSDK").create().makeExecutor(q,null,!0);b.enterExecution();for(var c=b.stack[0]["function"];!b.isExecutionDone();)b.execute();return c.getVariableValueByName(a)}),e||(l=b.explanation(g));var r=new j(q,l,b.language,m,p,n);return this.shownLevels[a].add(JSON.stringify(r)),r}}]),a}(),l=function(){function a(){c(this,a),this.codeOutput=this.codeOutput||{},this.codeOutput.codeOutput=Handlebars.template({1:function(a,b,c,d,e){return"                        <div class='program-container'></div>\n"},3:function(a,b,c,d,e){var f;return"                        <div id='segmented-control-container"+a.escapeExpression((f=null!=(f=c.id||(null!=b?b.id:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:a.nullContext||{},{name:"id",hash:{},data:e}):f))+"' class='segmented-control'></div>\n                        <div class='code'></div>\n"},5:function(a,b,c,d,e){return"                    <td class='console-container'>\n                        <div class='IO-container'>\n                            <div class='input-container'>\n                                <div class='IO-label'>Input</div>\n                                <div class='input-div'></div>\n                            </div>\n                            <div class='IO-label'>Output</div>\n                            <textarea class='console' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false'></textarea>\n                        </div>\n                    </td>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{};return"<div class='tool-container'>\n    <div class='console character-sizing'>x</div>\n    <p id='prompt'>Type the program's output.</p>\n    <table>\n        <tbody>\n            <tr>\n                <td>\n"+(null!=(f=c["if"].call(g,null!=b?b.isCodeZyFlowchart:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.program(3,e,0),data:e}))?f:"")+"                </td>\n"+(null!=(f=c.unless.call(g,null!=b?b.isCodeZyFlowchart:b,{name:"unless",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:"")+"            </tr>\n        </tbody>\n    </table>\n</div>\n"},useData:!0}),this.codeOutput.codeOutputAccessible=Handlebars.template({1:function(a,b,c,d,e){var f;return"    <ul>\n"+(null!=(f=c.each.call(null!=b?b:a.nullContext||{},null!=(f=null!=b?b.question:b)?f.files:f,{name:"each",hash:{},fn:a.program(2,e,0),inverse:a.noop,data:e}))?f:"")+"    </ul>\n"},2:function(a,b,c,d,e){var g,h=null!=b?b:a.nullContext||{},i=c.helperMissing,j="function",k=a.escapeExpression;return"            <li>\n                <p>"+k((g=null!=(g=c.filename||(null!=b?b.filename:b))?g:i,("undefined"==typeof g?"undefined":f(g))===j?g.call(h,{name:"filename",hash:{},data:e}):g))+"</p>\n                <pre>"+k((g=null!=(g=c.program||(null!=b?b.program:b))?g:i,("undefined"==typeof g?"undefined":f(g))===j?g.call(h,{name:"program",hash:{},data:e}):g))+"</pre>\n            </li>\n"},4:function(a,b,c,d,e){var f;return null!=(f=c.each.call(null!=b?b:a.nullContext||{},null!=(f=null!=b?b.question:b)?f.files:f,{name:"each",hash:{},fn:a.program(5,e,0),inverse:a.noop,data:e}))?f:""},5:function(a,b,c,d,e){var f;return"        <pre>"+a.escapeExpression((f=null!=(f=c.program||(null!=b?b.program:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:a.nullContext||{},{name:"program",hash:{},data:e}):f))+"</pre>\n"},7:function(a,b,c,d,e){var f;return"    <p>Program's input:</p>\n    <pre>"+a.escapeExpression(a.lambda(null!=(f=null!=b?b.question:b)?f.input:f,b))+"</pre>\n"},9:function(a,b,c,d,e){var f;return"    <p>Explanation: "+(null!=(f=a.lambda(null!=(f=null!=b?b.question:b)?f.explanation:f,b))?f:"")+"</p>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{};return"<p>Program:</p>\n"+(null!=(f=c["if"].call(g,null!=b?b.hasMultipleFiles:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.program(4,e,0),data:e}))?f:"")+"\n"+(null!=(f=c["if"].call(g,null!=(f=null!=b?b.question:b)?f.hasInput:f,{name:"if",hash:{},fn:a.program(7,e,0),inverse:a.noop,data:e}))?f:"")+"<p>Program's output:</p>\n<pre>"+a.escapeExpression(a.lambda(null!=(f=null!=b?b.question:b)?f.expectedAnswer:f,b))+"</pre>\n\n"+(null!=(f=c["if"].call(g,null!=(f=null!=b?b.question:b)?f.explanation:f,{name:"if",hash:{},fn:a.program(9,e,0),inverse:a.noop,data:e}))?f:"")},useData:!0}),this.codeOutput.explanation=Handlebars.template({1:function(a,b,c,d,e){var f;return"    "+a.escapeExpression((f=null!=(f=c.hintMessage||(null!=b?b.hintMessage:b))?f:c.helperMissing,"function"==typeof f?f.call(null!=b?b:a.nullContext||{},{name:"hintMessage",hash:{},data:e}):f))+"\n"},3:function(a,b,c,d,e){var f,g;return"    <p class='explanation-text'>"+(null!=(g=null!=(g=c.explanation||(null!=b?b.explanation:b))?g:c.helperMissing,f="function"==typeof g?g.call(null!=b?b:a.nullContext||{},{name:"explanation",hash:{},data:e}):g)?f:"")+"</p>\n"},5:function(a,b,c,d,e){var f,g;return"                    <div class='output user-output'>"+(null!=(g=null!=(g=c.userOutput||(null!=b?b.userOutput:b))?g:c.helperMissing,f="function"==typeof g?g.call(null!=b?b:a.nullContext||{},{name:"userOutput",hash:{},data:e}):g)?f:"")+"</div>\n"},7:function(a,b,c,d,e){return"                    <div class='no-result-value'>Yours has no output</div>\n"},9:function(a,b,c,d,e){var g,h,i=null!=b?b:a.nullContext||{},j=c.helperMissing,k="function";return"                    <div class='expected-output-container'>\n                        <div class='output expected-output'>"+(null!=(h=null!=(h=c.expectedOutput||(null!=b?b.expectedOutput:b))?h:j,g=("undefined"==typeof h?"undefined":f(h))===k?h.call(i,{name:"expectedOutput",hash:{},data:e}):h)?g:"")+"</div>\n                        <div class='newline-messaging'>"+(null!=(h=null!=(h=c.newlineMessaging||(null!=b?b.newlineMessaging:b))?h:j,g=("undefined"==typeof h?"undefined":f(h))===k?h.call(i,{name:"newlineMessaging",hash:{},data:e}):h)?g:"")+"</div>\n                    </div>\n"},11:function(a,b,c,d,e){return"                    <div class='no-result-value'>Expected no output</div>\n"},13:function(a,b,c,d,e){return"    <div>\n        Learn more: <button class='zb-button secondary thin-title special-character-legend'>\n            <span class='title'>Special character legend</span>\n        </button>\n    </div>\n"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g=null!=b?b:a.nullContext||{};return(null!=(f=c["if"].call(g,null!=b?b.hintMessage:b,{name:"if",hash:{},fn:a.program(1,e,0),inverse:a.program(3,e,0),data:e}))?f:"")+"<div>\n    <table class='explanation-table'>\n        <tr>\n            <td class='explanation-description'>Yours</td>\n            <td>\n"+(null!=(f=c["if"].call(g,null!=b?b.userOutput:b,{name:"if",hash:{},fn:a.program(5,e,0),inverse:a.program(7,e,0),data:e}))?f:"")+"            </td>\n        </tr>\n        <tr>\n            <td class='explanation-description'>Expected</td>\n            <td>\n"+(null!=(f=c["if"].call(g,null!=b?b.expectedOutput:b,{name:"if",hash:{},fn:a.program(9,e,0),inverse:a.program(11,e,0),data:e}))?f:"")+"            </td>\n        </tr>\n    </table>\n</div>\n"+(null!=(f=c["if"].call(g,null!=b?b.showSpecialCharacterLegendButton:b,{name:"if",hash:{},fn:a.program(13,e,0),inverse:a.noop,data:e}))?f:"")},useData:!0}),this.codeOutput.highlightedLine=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f,g;return"<span class='code-diff-highlight'>"+(null!=(g=null!=(g=c.code||(null!=b?b.code:b))?g:c.helperMissing,f="function"==typeof g?g.call(null!=b?b:a.nullContext||{},{name:"code",hash:{},data:e}):g)?f:"")+"</span>"},useData:!0}),this.id=null,this.progressionTool=null,this.segmentedControl=null,this.characterHeight=null,this.characterWidth=null,this.currentQuestion=null,this.previousQuestionNearlyCorrect=!1,this.previousQuestionIndex=null,this.isCodeZyFlowchart=null,this.zyFlowchartRenderType=null,this.executorController=null,this.questionFactory=null,this.questionCache=null,this.templates=null,this.parentResource=null,this.highlightNew=!1}return g(a,[{key:"init",value:function(a,b,c){var e=this;this.id=a,this.progressionTool=require("progressionTool").create(),this.parentResource=b,this.highlightNew=c&&c.highlightNew;var f=b.isExam&&b.isExam(),g=(c.levels||c.questions).map(function(a){var b=a.explanation||"",d=a.input||"",e=a.outputFilename||"";return new h(a.template,a.parameters,b,c.language,d,e)}),i=5,j=c.globalCode||"";this.questionFactory=new k(g,j),this.questionCache=require("utilities").getQuestionCache(this.questionFactory,i),this.isCodeZyFlowchart=d(c.language),this.isCodeZyFlowchart&&(this.zyFlowchartRenderType=m[c.language]);var l='<style>.zyante-bold{font-family:HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif;font-weight:300}.zyante-section-bold{font-family:Helvetica;font-weight:300}div.codeOutput{min-width:900px}div.codeOutput .console{line-height:normal;font-size:24px}div.codeOutput textarea.console{-moz-border-radius:5px;background:#f3f3f3;border-radius:5px;border:1px solid #000;font-family:"Courier New",monospace;overflow:hidden;padding:8px;resize:none}div.codeOutput textarea.console:not(:disabled){border-color:#333;box-shadow:inset 0 1px 2px rgba(0,0,0,.075),0 0 5px rgba(51,51,51,.5);outline:0}div.codeOutput div.tool-container>p{font-size:18px;padding-bottom:10px;text-align:center}div.codeOutput div.tool-container>table{margin:0 auto}div.codeOutput div.tool-container>table .console-container{min-width:230px;padding-left:15px;text-align:left}div.codeOutput div.tool-container>table span.code-diff-highlight{background-color:#dbedff}div.codeOutput div.tool-container div.segmented-control{margin-bottom:8px}div.codeOutput div.tool-container div.input-container{margin-bottom:15px}div.codeOutput div.tool-container div.IO-label{margin-bottom:2px}div.codeOutput div.tool-container div.input-div{-moz-appearance:textfield-multiline;-webkit-appearance:textarea;-webkit-box-shadow:inset 1px 1px 1px 0 #ccc;-moz-box-shadow:inset 1px 1px 1px 0 #ccc;background-color:#efefef;border:1px solid #ccc;box-shadow:inset 1px 1px 1px 0 #ccc;height:auto;max-height:200px;overflow-y:auto;padding:2px;white-space:pre}div.codeOutput p.explanation-text{display:inline;white-space:pre-line}div.codeOutput table.explanation-table{color:#333;display:inline-table;font-size:16px;margin-top:15px;vertical-align:-50%}div.codeOutput table.explanation-table td{padding-bottom:8px}div.codeOutput table.explanation-table td.explanation-description{text-align:right;padding-right:10px}div.codeOutput table.explanation-table td div.expected-output-container{display:flex}div.codeOutput table.explanation-table td div.expected-output-container div.newline-messaging span.newline-message{font-size:12px}div.codeOutput table.explanation-table td div.output,div.codeOutput table.explanation-table td div.newline-messaging{border-width:1px;box-sizing:border-box;color:#37474f;display:inline-block;font-family:"Courier New",monospace;margin:0;overflow-x:auto;padding:4px 10px;white-space:pre}div.codeOutput table.explanation-table td div.output{background-color:#f5f5f5;border-style:solid;border-color:rgba(189,189,189,.5);border-radius:2px}div.codeOutput table.explanation-table td div.no-result-value{color:#B90B13;font-style:italic}div.codeOutput div.console.character-sizing{border:0;padding:0}</style>';this.isCodeZyFlowchart&&(l+=require("zyFlowchartSDK").create().css,$("#"+a).addClass("zyFlowchartSDK")),this.templates=this.codeOutput;var n=this.templates.codeOutput({id:a,isCodeZyFlowchart:this.isCodeZyFlowchart}),o=0;this.progressionTool.init(a,b,{html:n,css:l,numToWin:g.length,useMultipleParts:!0,start:function(){e.makeLevel(0),e.lookupClass("console").focus(),e.isCodeZyFlowchart&&e.executorController.setIsSegmentedLanguageControlEnabled(!0)},reset:function(){e.makeLevel(0,!0),e.lookupClass("console").attr("disabled",!0)},next:function(a){f&&a===o?e.lookupClass("console").attr("disabled",!1):e.makeLevel(a),e.lookupClass("console").focus(),e.isCodeZyFlowchart&&e.executorController.setIsSegmentedLanguageControlEnabled(!0),o=a},isCorrect:function(a){return e.isCodeZyFlowchart&&e.executorController.setIsSegmentedLanguageControlEnabled(!1),e.currentQuestion.isServerRequestRejected()&&e.currentQuestion.setExpectedAnswer(e.parentResource),new Ember.RSVP.Promise(function(c,d){e.currentQuestion.serverRequestPromise.then(function(){var d=e.lookupClass("console").val(),g=e.currentQuestion.expectedAnswer,h=d===g;if(e.lookupClass("console").attr("disabled",!0),b.buildStringDifferenceObject)b.buildStringDifferenceObject(g,d).then(function(i){var j=i.expectedAnswerDiffIndices.map(function(a){return g[a]}),k=j.some(function(a){return/\n/.test(a)});e.resolveIsCorrect({currentQuestionIndex:a,expectedAnswer:g,expectedOutput:i.expectedAnswerHTML,expectedOutputDiffIndices:i.expectedAnswerDiffIndices,isCorrect:h,isExam:f,parentResource:b,resolve:c,showSpecialCharacterLegendButton:i.isReplacementADifference||i.isWhitespaceADifference,userAnswer:d,userOutput:i.userAnswerHTML,wasNewlineExpectedButMissing:k})});else{var i=require("utilities").manageDiffHighlighting(b,g,d);e.resolveIsCorrect({currentQuestionIndex:a,expectedAnswer:g,expectedOutput:i.highlightedExpectedOutput,expectedOutputDiffIndices:i.expectedOutputDiffIndices,isCorrect:h,parentResource:b,resolve:c,showSpecialCharacterLegendButton:!1,userAnswer:d,userOutput:i.highlightedActualOutput,wasNewlineExpectedButMissing:i.wasNewlineExpectedButMissing})}},function(a){d(a)})})},accessibleViewForLevel:function(a){var b=e.questionCache.makeQuestion(a),c=b.files.length>1;return b.setExpectedAnswer(e.parentResource),new Ember.RSVP.Promise(function(a,d){b.serverRequestPromise.then(function(){var d=e.templates.codeOutputAccessible({hasMultipleFiles:c,question:b});a(d)},function(a){d(a)})})}});var p=b.needsAccessible&&b.needsAccessible();if(!p){var q=this.lookupClass("character-sizing"),r=q.get(0).getBoundingClientRect();this.characterHeight=r.height,this.characterWidth=r.width,q.remove(),this.makeLevel(0,!0),this.lookupClass("console").attr("disabled",!0),this.isCodeZyFlowchart||this.lookupClass("console").on("input",function(){return e.adjustConsoleSize()})}}},{key:"resolveIsCorrect",value:function(a){var b=this,c="";if(a.wasNewlineExpectedButMissing){var d=function(b){return b.filter(function(b){return/[\n|\r]/.test(a.expectedAnswer[b])})},e=d(a.expectedOutputDiffIndices),f=a.expectedAnswer.split("").map(function(a,b){return b}),g=d(f),h='<span class="newline-message">You are missing a newline here.</span>',i='<span class="newline-message">Create your missing newline by pressing Enter on your keyboard.</span>',j='<span class="newline-message">You are missing a newline on the last line of your output.</span>',k=!1;c=g.map(function(b){var c="";return e.includes(b)&&(k?c=b===a.expectedAnswer.length-1?j:h:(c=i,k=!0)),c+"\n"}).join("")}var l="";if(!a.isCorrect){var m=require("utilities").removeWhitespace(a.expectedAnswer),n=require("utilities").removeWhitespace(a.userAnswer),o=m===n,p=a.expectedAnswer.toLowerCase()===a.userAnswer.toLowerCase(),q=m.toLowerCase()===n.toLowerCase();q&&(l="Output is nearly correct. ",l+=o?"Whitespace differs":p?"Capitalization differs":"Whitespace and capitalization differ",l+=".")}var r=this.templates.explanation({expectedOutput:a.expectedOutput,explanation:this.currentQuestion.explanation,hintMessage:l,newlineMessaging:c,showSpecialCharacterLegendButton:a.showSpecialCharacterLegendButton,userOutput:a.userOutput}),s=r+require("utilities").getNewline(),t=this.lookupClass("tool-container").width();a.resolve({explanationMessage:a.isExam?"":s,userAnswer:a.userAnswer,expectedAnswer:a.expectedAnswer,isCorrect:a.isCorrect,callbackFunction:function(){b.lookupClass("zyante-progression-explanation-area").width(t),b.lookupClass("special-character-legend").click(function(){a.parentResource.showSpecialCharacterLegendModal&&a.parentResource.showSpecialCharacterLegendModal()})}}),this.previousQuestionNearlyCorrect=l,this.previousQuestionIndex=a.currentQuestionIndex}},{key:"adjustConsoleSize",value:function(){var a=this.lookupClass("console"),c=a.val(),d=(c||"").split("\n");a.css("height",this.characterHeight*d.length);var e=d.map(function(a){return a.length}),f=Math.max.apply(Math,[1].concat(b(e))),g=navigator.userAgent.match(/(iphone|ipod|ipad)/i)?6:0,h=Math.ceil(this.characterWidth*f+g);a.css("width",h)}},{key:"updateConsoleText",value:function(a){this.lookupClass("console").val(a),this.adjustConsoleSize()}},{key:"makeColorizedAndHighlightedCode",value:function(a,b){var c=this,d=a,e=[],f=2;if(this.highlightNew&&b>0){var g=a.split("\n"),h="";switch(this.currentQuestion.language){case"c":case"cpp":case"java":h="//";break;case"python":case"python3":h="#"}g.unshift(h+' "New" means new compared to previous level'),e=g.map(function(a,b){return{line:a,index:b}}).filter(function(a){return/New/.test(a.line)}).map(function(a){return a.index}),e.length>=f&&(d=g.join("\n"))}var i="python3"===this.currentQuestion.language?"python":this.currentQuestion.language,j=this.parentResource.highlightCode(d,i);if(e.length>=f){var k=j.split("\n");e.forEach(function(a){k[a]=c.templates.highlightedLine({code:k[a]})}),j=k.join("\n")}return j}},{key:"makeLevel",value:function(a){var b=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;this.lookupClass("console").attr("disabled",!1);var d=this.previousQuestionNearlyCorrect&&this.previousQuestionIndex===a;if(this.previousQuestionNearlyCorrect=!1,!d){this.currentQuestion&&this.currentQuestion.stopServerRequest(),this.currentQuestion=this.questionCache.makeQuestion(a),this.currentQuestion.setExpectedAnswer(this.parentResource);var e="program's output";this.currentQuestion.useOutputFile&&(e="contents of "+this.currentQuestion.outputFilename),$("#"+this.id+" p#prompt").text("Type the "+e),this.currentQuestion.files.forEach(function(c){b.isCodeZyFlowchart?c.programToShow=require("utilities").escapeHTML(c.program):c.programToShow=b.makeColorizedAndHighlightedCode(c.program,a)});var f=this.questionFactory.levels[a].parameters,g="string"==typeof f?"unknown":require("utilities").getNumberOfPermutations(f);if(this.parentResource.setPermutationsShownAndTotal&&this.parentResource.setPermutationsShownAndTotal({shown:this.questionFactory.shownLevels[a].size,total:g}),this.isCodeZyFlowchart)this.displayZyFlowchartCurrentQuestion();else{this.displayTextualCodeCurrentQuestion();var h=this.lookupClass("input-div"),i=this.lookupClass("IO-label"),j=this.lookupClass("input-container");if(this.currentQuestion.hasInput){j.show(),i.show(),h.text(this.currentQuestion.input);var k=this.lookupClass("code").width(),l=960,m=50,n=l-k-m;h.css("maxWidth",n)}else j.hide(),i.hide()}this.updateConsoleText(""),this.parentResource.setSolution(" ")}c&&this.currentQuestion.serverRequestPromise.then(function(){b.updateConsoleText(b.currentQuestion.expectedAnswer)}),this.parentResource.setSolution&&this.currentQuestion.serverRequestPromise.then(function(){b.parentResource.setSolution(b.currentQuestion.expectedAnswer)})}},{key:"displayZyFlowchartCurrentQuestion",value:function(){var a=this,b=null,c=require("zyFlowchartSDK").create();try{b=c.makeExecutor(this.currentQuestion.code,this.currentQuestion.input||null,!0)}catch(d){return}var e=this.lookupClass("program-container"),f=550,g=900;this.executorController=c.makeExecutorController(b,e),this.executorController.setIsCompact(!0,f,g),this.executorController.setIsOutputEditable(!0,function(){return a.adjustConsoleSize()}),this.executorController.setIsInputEditable(!1),this.executorController.setLanguagesToShow(this.zyFlowchartRenderType),this.executorController.setIsSegmentedLanguageControlEnabled(!1),this.executorController.render(),$("#"+this.id+" .function-container").css("pointer-events","auto")}},{key:"displayTextualCodeCurrentQuestion",value:function(){var a=this,c=this.getSegmentedControllerContainerID(),d=$("#"+c);this.currentQuestion.files.length>1?d.show():d.hide();var e=this.lookupClass("code"),f=this.currentQuestion.files.map(function(a){return a.filename});e.width("auto"),this.segmentedControl=require("segmentedControl").create(),this.segmentedControl.init(f,c,function(b,c){var d=a.currentQuestion.files.find(function(a){return a.filename===c});e.html(d.programToShow)}),d.click(function(){return a.lookupClass("console").focus()});var g=f.map(function(b){return a.segmentedControl.selectSegmentByTitle(b),e.width()}),h=Math.max.apply(Math,b(g));e.width(h),this.segmentedControl.selectSegmentByTitle(this.currentQuestion.files.find(function(a){return a.main}).filename)}},{key:"getSegmentedControllerContainerID",value:function(){return"segmented-control-container"+this.id}},{key:"lookupClass",value:function(a){return $("#"+this.id).find("."+a)}},{key:"reset",value:function(){this.progressionTool.reset()}}]),a}();e.exports={create:function(){return new l},dependencies:{tools:["utilities","progressionTool","segmentedControl","zyFlowchartSDK"],vendorJS:["handlebars.1.3.0.min.js","skulpt.min.js","skulpt-stdlib.js"]},runTests:function(){},supportsAccessible:!0};var m={zyFlowchart:"flowchart",zyPseudocode:"pseudocode",zyFlowchartZyPseudocode:"both"};a["default"]=e.exports});